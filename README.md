<a name="readme-top"></a>

# Megamen, хакатон «Цифровой прорыв», кейс от Центрального Банка РФ "Анализатор текстовых пресс-релизов: оценка взаимосвязи пресс-релиза и рейтинга"

**Содержание:**
1. Проблематика кейсодержателя
2. Описание решения
3. Развертка приложения
4. Демонстрация работы


# Часть 1. Проблематика кейсодержателя
В кейсе рассматривается работа с реальными пресс-релизами КРА, поэтому команда решает несколько важных задач обучения модели:
* Корректное определение рейтинга на основании контекста;
* Соотношение кредитного рейтинга пресс-релизу;
* Выделение ключевых конструкций, соответствующих присвоенному рейтингу.

В реальных условиях субъективность оценок КРА может привести к:
* Отсутствию прозрачности;
* Некорректности обоснования рейтинга;
* Махинациям в сфере кредитования.

Решения, используемые на данный момент, обладают несколькими недостатками:
1. Зачастую используется ручная проверка данных;
2. Не используя в своей основе машинное обучение, решения не могут учесть все возможные случаи введенных данных;
3. Ввиду не самого высокого качества таких решений, для корректной разметки приходится привлекать человеческие ресурсы, что влечет за собой дополнительные издержки.

Внедрение нашего решения на основе систем машинного обучения позволит:
1. Повысить автоматизацию, качество и эффективность труда;
2. Увеличить качество и скорость обработки запросов; 
3. Уменьшит стоимость разметки данных (ввиду уменьшения ручной разметки специалистами).
<p align="right">(<a href="#readme-top"><i>Вернуться наверх</i></a>)</p>

# Часть 2. Описание решения
В поисках наиболее подходящего подхода были протестированы несколько возможных вариантов решения:
1. Ручная разметка данных по классам, решение задачи named entity recognition и последющий поиск наиболее релевантных запросов
2. Rule-based разметка данных
3. Получение эмбеддингов при помощи encoder-only моделей и последующее сравнение с эталонными адресами

Рассмотрим каждый из указанных подходов:
1. Ручная разметка достаточного количества объектов для обучения занимает продолжительное время, такое решение не сможет быстро адаптироваться к изменениям в данных, а сами ner-модели занимают много пространства и достаточно медленны в совершении предсказаний
2. Rule-based разметка (например, на основе регулярных выражений), неустойчива к опечаткам пользователей — даже в случае одной опечатки (попадания по соседней клавише, например) данный подход не сможет выдать верный результат
3. Новые модели (например, sentence-bert) обучены именно под поиск семантических схожестей, а также обладают высокой скоростью инференса даже на CPU. Из минусов можно отметить необходимость хранить векторные представления (эмбеддинги) под каждый объект базы данных

Исходя из требований к решению (масшатбируемость и высокое качество распознавания), было принято решение за основу взять третий подход — получение векторных представлений введенного пользователем объекта. 

В результате Мы представляем модель для определения корректного рейтинга компании на основе предоставленного пресс-релиза. Модель сможет адаптироваться к различным форматам пресс-релизов, находить в них ключевые слова и корректно определять детализированный и укрупненный рейтинг - таким образом, она будет полезна для верификации рейтингов компании, исключения субъективности в присваиваемой оценке.

## Схема решения 
1. Парсинг новых данных
2. Предобработка
3. Векторизация
4. CatBoost
(отдельной веткой)
3. Fine-tuning + Classifier
6. Итоговые labels 1 и labels 2
7. CatBoost

### Ход решения
![Image alt](https://github.com/mireaMegaman/nn_hackaton/blob/main/pics/tech_test6.png)

### Архитектура решения
![Image alt](https://github.com/mireaMegaman/nn_hackaton/blob/main/pics/arch_test4.png)

### Стек технологий
![Image alt](https://github.com/mireaMegaman/nn_hackaton/blob/main/pics/dia_test4.png)

<p align="right">(<a href="#readme-top"><i>Вернуться наверх</i></a>)</p>

# Часть 3. Развертка

https://hub.docker.com/repository/docker/georgechufff/hacks_ai_spb/

```
docker build ...
docker run ...
```
open smth

<p align="right">(<a href="#readme-top"><i>Вернуться наверх</i></a>)</p>

# Демонстрация работы
** https://youtu.be/9tO_A9K-VEc **

<p align="right">(<a href="#readme-top"><i>Вернуться наверх</i></a>)</p>
